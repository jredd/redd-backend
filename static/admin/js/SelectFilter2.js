!function(e){function t(e){return"form"!=e.tagName.toLowerCase()?t(e.parentNode):e}window.SelectFilter={init:function(l,o,i,n){if(!l.match(/__prefix__/)){var c=document.getElementById(l);c.id+="_from",c.className="filtered";for(var r=c.parentNode.getElementsByTagName("p"),a=0;a<r.length;a++)-1!=r[a].className.indexOf("info")?c.parentNode.removeChild(r[a]):-1!=r[a].className.indexOf("help")&&c.parentNode.insertBefore(r[a],c.parentNode.firstChild);var s=quickElement("div",c.parentNode);s.className=i?"selector stacked":"selector";var d=quickElement("div",s);d.className="selector-available";var m=quickElement("h2",d,interpolate(gettext("Available %s")+" ",[o]));quickElement("img",m,"","src",n+"img/icon-unknown.gif","width","10","height","10","class","help help-tooltip","title",interpolate(gettext('This is the list of available %s. You may choose some by selecting them in the box below and then clicking the "Choose" arrow between the two boxes.'),[o]));var h=quickElement("p",d,"","id",l+"_filter");h.className="selector-filter";{var f=quickElement("label",h,"","for",l+"_input");quickElement("img",f,"","src",n+"img/selector-search.gif","class","help-tooltip","alt","","title",interpolate(gettext("Type into this box to filter down the list of available %s."),[o]))}h.appendChild(document.createTextNode(" "));var _=quickElement("input",h,"","type","text","placeholder",gettext("Filter"));_.id=l+"_input",d.appendChild(c);var u=quickElement("a",d,gettext("Choose all"),"title",interpolate(gettext("Click to choose all %s at once."),[o]),"href",'javascript: (function(){ SelectBox.move_all("'+l+'_from", "'+l+'_to"); SelectFilter.refresh_icons("'+l+'");})()',"id",l+"_add_all_link");u.className="selector-chooseall";var v=quickElement("ul",s);v.className="selector-chooser";var g=quickElement("a",quickElement("li",v),gettext("Choose"),"title",gettext("Choose"),"href",'javascript: (function(){ SelectBox.move("'+l+'_from","'+l+'_to"); SelectFilter.refresh_icons("'+l+'");})()',"id",l+"_add_link");g.className="selector-add";var k=quickElement("a",quickElement("li",v),gettext("Remove"),"title",gettext("Remove"),"href",'javascript: (function(){ SelectBox.move("'+l+'_to","'+l+'_from"); SelectFilter.refresh_icons("'+l+'");})()',"id",l+"_remove_link");k.className="selector-remove";var p=quickElement("div",s);p.className="selector-chosen";var x=quickElement("h2",p,interpolate(gettext("Chosen %s")+" ",[o]));quickElement("img",x,"","src",n+"img/icon-unknown.gif","width","10","height","10","class","help help-tooltip","title",interpolate(gettext('This is the list of chosen %s. You may remove some by selecting them in the box below and then clicking the "Remove" arrow between the two boxes.'),[o]));var E=quickElement("select",p,"","id",l+"_to","multiple","multiple","size",c.size,"name",c.getAttribute("name"));E.className="filtered";var w=quickElement("a",p,gettext("Remove all"),"title",interpolate(gettext("Click to remove all chosen %s at once."),[o]),"href",'javascript: (function() { SelectBox.move_all("'+l+'_to", "'+l+'_from"); SelectFilter.refresh_icons("'+l+'");})()',"id",l+"_remove_all_link");if(w.className="selector-clearall",c.setAttribute("name",c.getAttribute("name")+"_old"),addEvent(_,"keyup",function(e){SelectFilter.filter_key_up(e,l)}),addEvent(_,"keydown",function(e){SelectFilter.filter_key_down(e,l)}),addEvent(c,"change",function(){SelectFilter.refresh_icons(l)}),addEvent(E,"change",function(){SelectFilter.refresh_icons(l)}),addEvent(c,"dblclick",function(){SelectBox.move(l+"_from",l+"_to"),SelectFilter.refresh_icons(l)}),addEvent(E,"dblclick",function(){SelectBox.move(l+"_to",l+"_from"),SelectFilter.refresh_icons(l)}),addEvent(t(c),"submit",function(){SelectBox.select_all(l+"_to")}),SelectBox.init(l+"_from"),SelectBox.init(l+"_to"),SelectBox.move(l+"_from",l+"_to"),!i){var y=e(c),S=e(E),C=function(){S.height(e(h).outerHeight()+y.outerHeight())};y.outerHeight()>0?C():S.closest("fieldset").one("show.fieldset",C)}SelectFilter.refresh_icons(l)}},refresh_icons:function(t){var l=e("#"+t+"_from"),o=e("#"+t+"_to"),i=l.find("option:selected").length>0,n=o.find("option:selected").length>0;e("#"+t+"_add_link").toggleClass("active",i),e("#"+t+"_remove_link").toggleClass("active",n),e("#"+t+"_add_all_link").toggleClass("active",l.find("option").length>0),e("#"+t+"_remove_all_link").toggleClass("active",o.find("option").length>0)},filter_key_up:function(e,t){var l=document.getElementById(t+"_from");if(e.which&&13==e.which||e.keyCode&&13==e.keyCode)return l.selectedIndex=0,SelectBox.move(t+"_from",t+"_to"),l.selectedIndex=0,!1;var o=l.selectedIndex;return SelectBox.filter(t+"_from",document.getElementById(t+"_input").value),l.selectedIndex=o,!0},filter_key_down:function(e,t){var l=document.getElementById(t+"_from");if(e.which&&39==e.which||e.keyCode&&39==e.keyCode){var o=l.selectedIndex;return SelectBox.move(t+"_from",t+"_to"),l.selectedIndex=o==l.length?l.length-1:o,!1}return(e.which&&40==e.which||e.keyCode&&40==e.keyCode)&&(l.selectedIndex=l.length==l.selectedIndex+1?0:l.selectedIndex+1),(e.which&&38==e.which||e.keyCode&&38==e.keyCode)&&(l.selectedIndex=0==l.selectedIndex?l.length-1:l.selectedIndex-1),!0}}}(django.jQuery);