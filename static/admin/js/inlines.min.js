!function(e){e.fn.formset=function(t){var a=e.extend({},e.fn.formset.defaults,t),i=e(this);t=i.parent();var s=function(t,a,i){var s=RegExp("("+a+"-(\\d+|__prefix__))");a=a+"-"+i,e(t).prop("for")&&e(t).prop("for",e(t).prop("for").replace(s,a)),t.id&&(t.id=t.id.replace(s,a)),t.name&&(t.name=t.name.replace(s,a))},n=e("#id_"+a.prefix+"-TOTAL_FORMS").prop("autocomplete","off"),r=parseInt(n.val(),10),l=e("#id_"+a.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off");if(n=""===l.val()||l.val()-n.val()>0,i.each(function(){e(this).not("."+a.emptyCssClass).addClass(a.formCssClass)}),i.length&&n){var d;"TR"==i.prop("tagName")?(i=this.eq(-1).children().length,t.append('<tr class="'+a.addCssClass+'"><td colspan="'+i+'"><a href="javascript:void(0)">'+a.addText+"</a></tr>"),d=t.find("tr:last a")):(i.filter(":last").after('<div class="'+a.addCssClass+'"><a href="javascript:void(0)">'+a.addText+"</a></div>"),d=i.filter(":last").next().find("a")),d.click(function(t){t.preventDefault();var i=e("#id_"+a.prefix+"-TOTAL_FORMS");t=e("#"+a.prefix+"-empty");var n=t.clone(!0);n.removeClass(a.emptyCssClass).addClass(a.formCssClass).attr("id",a.prefix+"-"+r),n.is("tr")?n.children(":last").append('<div><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></div>"):n.is("ul")||n.is("ol")?n.append('<li><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></li>"):n.children(":first").append('<span><a class="'+a.deleteCssClass+'" href="javascript:void(0)">'+a.deleteText+"</a></span>"),n.find("*").each(function(){s(this,a.prefix,i.val())}),n.insertBefore(e(t)),e(i).val(parseInt(i.val(),10)+1),r+=1,""!==l.val()&&l.val()-i.val()<=0&&d.parent().hide(),n.find("a."+a.deleteCssClass).click(function(t){t.preventDefault(),t=e(this).parents("."+a.formCssClass),t.remove(),r-=1,a.removed&&a.removed(t),t=e("."+a.formCssClass),e("#id_"+a.prefix+"-TOTAL_FORMS").val(t.length),(""===l.val()||l.val()-t.length>0)&&d.parent().show();for(var i=0,n=t.length;n>i;i++)s(e(t).get(i),a.prefix,i),e(t.get(i)).find("*").each(function(){s(this,a.prefix,i)})}),a.added&&a.added(n)})}return this},e.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null},e.fn.tabularFormset=function(t){var a=e(this),i=function(){e(a.selector).not(".add-row").removeClass("row1 row2").filter(":even").addClass("row1").end().filter(":odd").addClass("row2")},s=function(){"undefined"!=typeof SelectFilter&&(e(".selectfilter").each(function(e,a){var i=a.name.split("-");SelectFilter.init(a.id,i[i.length-1],!1,t.adminStaticPrefix)}),e(".selectfilterstacked").each(function(e,a){var i=a.name.split("-");SelectFilter.init(a.id,i[i.length-1],!0,t.adminStaticPrefix)}))},n=function(t){t.find(".prepopulated_field").each(function(){var a=e(this).find("input, select, textarea"),i=a.data("dependency_list")||[],s=[];e.each(i,function(e,a){s.push("#"+t.find(".field-"+a).find("input, select, textarea").attr("id"))}),s.length&&a.prepopulate(s,a.attr("maxlength"))})};return a.formset({prefix:t.prefix,addText:t.addText,formCssClass:"dynamic-"+t.prefix,deleteCssClass:"inline-deletelink",deleteText:t.deleteText,emptyCssClass:"empty-form",removed:i,added:function(t){n(t),"undefined"!=typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),s(),i(t)}}),a},e.fn.stackedFormset=function(t){var a=e(this),i=function(){e(a.selector).find(".inline_label").each(function(t){t+=1,e(this).html(e(this).html().replace(/(#\d+)/g,"#"+t))})},s=function(){"undefined"!=typeof SelectFilter&&(e(".selectfilter").each(function(e,a){var i=a.name.split("-");SelectFilter.init(a.id,i[i.length-1],!1,t.adminStaticPrefix)}),e(".selectfilterstacked").each(function(e,a){var i=a.name.split("-");SelectFilter.init(a.id,i[i.length-1],!0,t.adminStaticPrefix)}))},n=function(t){t.find(".prepopulated_field").each(function(){var a=e(this).find("input, select, textarea"),i=a.data("dependency_list")||[],s=[];e.each(i,function(e,a){s.push("#"+t.find(".form-row .field-"+a).find("input, select, textarea").attr("id"))}),s.length&&a.prepopulate(s,a.attr("maxlength"))})};return a.formset({prefix:t.prefix,addText:t.addText,formCssClass:"dynamic-"+t.prefix,deleteCssClass:"inline-deletelink",deleteText:t.deleteText,emptyCssClass:"empty-form",removed:i,added:function(t){n(t),"undefined"!=typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),s(),i(t)}}),a}}(django.jQuery);