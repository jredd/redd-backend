var DateTimeShortcuts={calendars:[],calendarInputs:[],clockInputs:[],dismissClockFunc:[],dismissCalendarFunc:[],calendarDivName1:"calendarbox",calendarDivName2:"calendarin",calendarLinkName:"calendarlink",clockDivName:"clockbox",clockLinkName:"clocklink",shortCutsClass:"datetimeshortcuts",timezoneWarningClass:"timezonewarning",timezoneOffset:0,admin_media_prefix:"",init:function(){if(DateTimeShortcuts.admin_media_prefix=void 0!=window.__admin_media_prefix__?window.__admin_media_prefix__:"/missing-admin-media-prefix/",void 0!=window.__admin_utc_offset__){var e=window.__admin_utc_offset__,t=-60*(new Date).getTimezoneOffset();DateTimeShortcuts.timezoneOffset=t-e}var a=document.getElementsByTagName("input");for(i=0;i<a.length;i++){var n=a[i];"text"==n.getAttribute("type")&&n.className.match(/vTimeField/)?(DateTimeShortcuts.addClock(n),DateTimeShortcuts.addTimezoneWarning(n)):"text"==n.getAttribute("type")&&n.className.match(/vDateField/)&&(DateTimeShortcuts.addCalendar(n),DateTimeShortcuts.addTimezoneWarning(n))}},now:function(){if(void 0!=window.__admin_utc_offset__){var e=window.__admin_utc_offset__,t=new Date,a=-60*t.getTimezoneOffset();return t.setTime(t.getTime()+1e3*(e-a)),t}return new Date},addTimezoneWarning:function(e){var t=django.jQuery,a=DateTimeShortcuts.timezoneWarningClass,i=DateTimeShortcuts.timezoneOffset/3600;if(i&&!t(e).siblings("."+a).length){var n;i>0?n=ngettext("Note: You are %s hour ahead of server time.","Note: You are %s hours ahead of server time.",i):(i*=-1,n=ngettext("Note: You are %s hour behind server time.","Note: You are %s hours behind server time.",i)),n=interpolate(n,[i]);var c=t("<span>");c.attr("class",a),c.text(n),t(e).parent().append(t("<br>")).append(c)}},addClock:function(e){var t=DateTimeShortcuts.clockInputs.length;DateTimeShortcuts.clockInputs[t]=e,DateTimeShortcuts.dismissClockFunc[t]=function(){return DateTimeShortcuts.dismissClock(t),!0};var a=document.createElement("span");a.className=DateTimeShortcuts.shortCutsClass,e.parentNode.insertBefore(a,e.nextSibling);var i=document.createElement("a");i.setAttribute("href","javascript:DateTimeShortcuts.handleClockQuicklink("+t+", -1);"),i.appendChild(document.createTextNode(gettext("Now")));var n=document.createElement("a");n.setAttribute("href","javascript:DateTimeShortcuts.openClock("+t+");"),n.id=DateTimeShortcuts.clockLinkName+t,quickElement("img",n,"","src",DateTimeShortcuts.admin_media_prefix+"img/icon_clock.gif","alt",gettext("Clock")),a.appendChild(document.createTextNode(" ")),a.appendChild(i),a.appendChild(document.createTextNode(" | ")),a.appendChild(n);var c=document.createElement("div");c.style.display="none",c.style.position="absolute",c.className="clockbox module",c.setAttribute("id",DateTimeShortcuts.clockDivName+t),document.body.appendChild(c),addEvent(c,"click",cancelEventPropagation),quickElement("h2",c,gettext("Choose a time"));var r=quickElement("ul",c);r.className="timelist",quickElement("a",quickElement("li",r),gettext("Now"),"href","javascript:DateTimeShortcuts.handleClockQuicklink("+t+", -1);"),quickElement("a",quickElement("li",r),gettext("Midnight"),"href","javascript:DateTimeShortcuts.handleClockQuicklink("+t+", 0);"),quickElement("a",quickElement("li",r),gettext("6 a.m."),"href","javascript:DateTimeShortcuts.handleClockQuicklink("+t+", 6);"),quickElement("a",quickElement("li",r),gettext("Noon"),"href","javascript:DateTimeShortcuts.handleClockQuicklink("+t+", 12);");var o=quickElement("p",c);o.className="calendar-cancel",quickElement("a",o,gettext("Cancel"),"href","javascript:DateTimeShortcuts.dismissClock("+t+");"),django.jQuery(document).bind("keyup",function(e){27==e.which&&(DateTimeShortcuts.dismissClock(t),e.preventDefault())})},openClock:function(e){var t=document.getElementById(DateTimeShortcuts.clockDivName+e),a=document.getElementById(DateTimeShortcuts.clockLinkName+e);t.style.left="rtl"!=getStyle(document.body,"direction")?findPosX(a)+17+"px":findPosX(a)-110+"px",t.style.top=Math.max(0,findPosY(a)-30)+"px",t.style.display="block",addEvent(document,"click",DateTimeShortcuts.dismissClockFunc[e])},dismissClock:function(e){document.getElementById(DateTimeShortcuts.clockDivName+e).style.display="none",removeEvent(document,"click",DateTimeShortcuts.dismissClockFunc[e])},handleClockQuicklink:function(e,t){var a;a=-1==t?DateTimeShortcuts.now():new Date(1970,1,1,t,0,0,0),DateTimeShortcuts.clockInputs[e].value=a.strftime(get_format("TIME_INPUT_FORMATS")[0]),DateTimeShortcuts.clockInputs[e].focus(),DateTimeShortcuts.dismissClock(e)},addCalendar:function(e){var t=DateTimeShortcuts.calendars.length;DateTimeShortcuts.calendarInputs[t]=e,DateTimeShortcuts.dismissCalendarFunc[t]=function(){return DateTimeShortcuts.dismissCalendar(t),!0};var a=document.createElement("span");a.className=DateTimeShortcuts.shortCutsClass,e.parentNode.insertBefore(a,e.nextSibling);var i=document.createElement("a");i.setAttribute("href","javascript:DateTimeShortcuts.handleCalendarQuickLink("+t+", 0);"),i.appendChild(document.createTextNode(gettext("Today")));var n=document.createElement("a");n.setAttribute("href","javascript:DateTimeShortcuts.openCalendar("+t+");"),n.id=DateTimeShortcuts.calendarLinkName+t,quickElement("img",n,"","src",DateTimeShortcuts.admin_media_prefix+"img/icon_calendar.gif","alt",gettext("Calendar")),a.appendChild(document.createTextNode(" ")),a.appendChild(i),a.appendChild(document.createTextNode(" | ")),a.appendChild(n);var c=document.createElement("div");c.style.display="none",c.style.position="absolute",c.className="calendarbox module",c.setAttribute("id",DateTimeShortcuts.calendarDivName1+t),document.body.appendChild(c),addEvent(c,"click",cancelEventPropagation);var r=quickElement("div",c),o=quickElement("a",r,"<","href","javascript:DateTimeShortcuts.drawPrev("+t+");");o.className="calendarnav-previous";var s=quickElement("a",r,">","href","javascript:DateTimeShortcuts.drawNext("+t+");");s.className="calendarnav-next";var d=quickElement("div",c,"","id",DateTimeShortcuts.calendarDivName2+t);d.className="calendar",DateTimeShortcuts.calendars[t]=new Calendar(DateTimeShortcuts.calendarDivName2+t,DateTimeShortcuts.handleCalendarCallback(t)),DateTimeShortcuts.calendars[t].drawCurrent();var l=quickElement("div",c);l.className="calendar-shortcuts",quickElement("a",l,gettext("Yesterday"),"href","javascript:DateTimeShortcuts.handleCalendarQuickLink("+t+", -1);"),l.appendChild(document.createTextNode(" | ")),quickElement("a",l,gettext("Today"),"href","javascript:DateTimeShortcuts.handleCalendarQuickLink("+t+", 0);"),l.appendChild(document.createTextNode(" | ")),quickElement("a",l,gettext("Tomorrow"),"href","javascript:DateTimeShortcuts.handleCalendarQuickLink("+t+", +1);");var m=quickElement("p",c);m.className="calendar-cancel",quickElement("a",m,gettext("Cancel"),"href","javascript:DateTimeShortcuts.dismissCalendar("+t+");"),django.jQuery(document).bind("keyup",function(e){27==e.which&&(DateTimeShortcuts.dismissCalendar(t),e.preventDefault())})},openCalendar:function(e){var t=document.getElementById(DateTimeShortcuts.calendarDivName1+e),a=document.getElementById(DateTimeShortcuts.calendarLinkName+e),i=DateTimeShortcuts.calendarInputs[e];if(i.value){var n=i.value.split("-"),c=n[0],r=parseFloat(n[1]),o=new Date(i.value);c.match(/\d\d\d\d/)&&r>=1&&12>=r&&DateTimeShortcuts.calendars[e].drawDate(r,c,o)}t.style.left="rtl"!=getStyle(document.body,"direction")?findPosX(a)+17+"px":findPosX(a)-180+"px",t.style.top=Math.max(0,findPosY(a)-75)+"px",t.style.display="block",addEvent(document,"click",DateTimeShortcuts.dismissCalendarFunc[e])},dismissCalendar:function(e){document.getElementById(DateTimeShortcuts.calendarDivName1+e).style.display="none",removeEvent(document,"click",DateTimeShortcuts.dismissCalendarFunc[e])},drawPrev:function(e){DateTimeShortcuts.calendars[e].drawPreviousMonth()},drawNext:function(e){DateTimeShortcuts.calendars[e].drawNextMonth()},handleCalendarCallback:function(e){var t=get_format("DATE_INPUT_FORMATS")[0];return t=t.replace("\\","\\\\"),t=t.replace("\r","\\r"),t=t.replace("\n","\\n"),t=t.replace("	","\\t"),t=t.replace("'","\\'"),["function(y, m, d) { DateTimeShortcuts.calendarInputs[",e,"].value = new Date(y, m-1, d).strftime('",t,"');DateTimeShortcuts.calendarInputs[",e,"].focus();document.getElementById(DateTimeShortcuts.calendarDivName1+",e,").style.display='none';}"].join("")},handleCalendarQuickLink:function(e,t){var a=DateTimeShortcuts.now();a.setDate(a.getDate()+t),DateTimeShortcuts.calendarInputs[e].value=a.strftime(get_format("DATE_INPUT_FORMATS")[0]),DateTimeShortcuts.calendarInputs[e].focus(),DateTimeShortcuts.dismissCalendar(e)}};addEvent(window,"load",DateTimeShortcuts.init);